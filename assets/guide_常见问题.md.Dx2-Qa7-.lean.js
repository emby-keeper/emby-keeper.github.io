import{_ as a,c as s,a3 as i,o as t}from"./chunks/framework.C-yY9WsR.js";const c=JSON.parse('{"title":"常见问题","description":"","frontmatter":{"outline":[2,3]},"headers":[],"relativePath":"guide/常见问题.md","filePath":"guide/常见问题.md"}'),r={name:"guide/常见问题.md"};function l(o,e,p,n,h,d){return t(),s("div",null,e[0]||(e[0]=[i(`<h1 id="常见问题" tabindex="-1">常见问题 <a class="header-anchor" href="#常见问题" aria-label="Permalink to &quot;常见问题&quot;">​</a></h1><h3 id="docker-镜像下载非常慢怎么办" tabindex="-1">Docker 镜像下载非常慢怎么办? <a class="header-anchor" href="#docker-镜像下载非常慢怎么办" aria-label="Permalink to &quot;Docker 镜像下载非常慢怎么办?&quot;">​</a></h3><p>这一般在国内下载镜像时出现, 有两种策略:</p><ol><li>使用 Docker 镜像: <a href="https://gist.github.com/y0ngb1n/7e8f16af3242c7815e7ca2f0833d3ea6" target="_blank" rel="noreferrer">教程</a></li><li>使 Docker Daemon 使用代理: <a href="https://www.moralok.com/2023/06/13/how-to-configure-proxy-for-terminal-docker-and-container/" target="_blank" rel="noreferrer">教程</a></li></ol><h3 id="我使用的平台是群晖等低内存平台-可以使用吗" tabindex="-1">我使用的平台是群晖等低内存平台, 可以使用吗? <a class="header-anchor" href="#我使用的平台是群晖等低内存平台-可以使用吗" aria-label="Permalink to &quot;我使用的平台是群晖等低内存平台, 可以使用吗?&quot;">​</a></h3><p>Embykeeper 需要运行内存为 100-300 MB, 这是因为运行过程中, 部分 Bot 签到需要进行验证码识别. 如果您在运行过程中有内存不足的情况, 请适当调高您的虚拟内存.</p><p>如果依然无法使用, 请考虑使用 <a href="/guide/在线部署"><strong>🪐 在线部署</strong></a>.</p><h3 id="我使用-docker-面板-后台日志显示很混乱-有-ansi-颜色字符-日志重复两遍-怎么办" tabindex="-1">我使用 Docker 面板, 后台日志显示很混乱 / 有 ANSI 颜色字符 / 日志重复两遍, 怎么办? <a class="header-anchor" href="#我使用-docker-面板-后台日志显示很混乱-有-ansi-颜色字符-日志重复两遍-怎么办" aria-label="Permalink to &quot;我使用 Docker 面板, 后台日志显示很混乱 / 有 ANSI 颜色字符 / 日志重复两遍, 怎么办?&quot;">​</a></h3><p>请使用命令行参数 <code>-CL</code> 以启用简化日志+无颜色日志:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pwd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/embykeeper:/app</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --net=host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> embykeeper/embykeeper</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -CL</span></span></code></pre></div><p>如果您使用 <code>docker-compose</code>, 请使用:</p><div class="language-yml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;3&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  embykeeper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    container_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">embykeeper</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">embykeeper/embykeeper</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;-CL&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    restart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">unless-stopped</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">./embykeeper:/app</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    network_mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">host</span></span></code></pre></div><p>如果您使用源码构建请使用:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">embykeeper</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> config.toml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -CL</span></span></code></pre></div><h3 id="emby-播放的视频是怎么选择的" tabindex="-1">Emby 播放的视频是怎么选择的? <a class="header-anchor" href="#emby-播放的视频是怎么选择的" aria-label="Permalink to &quot;Emby 播放的视频是怎么选择的?&quot;">​</a></h3><p>目前的策略是: 使用 &quot;Movie&quot; 或 &quot;Episode&quot; 分类中的<strong>随机</strong>的特定长度以上的视频.</p><p>为什么不能是最新视频? 因为可能存在 15 分钟黑屏等等类型的蜜罐视频, 很容易导致自动保号被管理员发现.</p><p>为什么不能是最老视频? 因为有的站点的最老视频文件丢失了会频繁出错.</p><p>为什么不能是最热视频? 因为 &quot;最热&quot; 在不同站点上的特性不同. 有的站点中 &quot;最热&quot; 会识别为当前用户播放最多的视频, 而不能获得所有用户播放最多的视频.</p><h3 id="emby-保活时-经常出现-无法获取视频长度-重试乃至失败怎么办" tabindex="-1">Emby 保活时, 经常出现 &quot;无法获取视频长度&quot;, 重试乃至失败怎么办? <a class="header-anchor" href="#emby-保活时-经常出现-无法获取视频长度-重试乃至失败怎么办" aria-label="Permalink to &quot;Emby 保活时, 经常出现 &quot;无法获取视频长度&quot;, 重试乃至失败怎么办?&quot;">​</a></h3><p>这说明该 Emby 站点很有可能是通过 Onedrive 直链等方法接入的, 大部分或所有视频都没有时长信息.</p><p>你可以开启 <code>allow_stream</code> 参数 (见<a href="/guide/配置文件#emby-子项">教程</a>) 以允许播放这类视频.</p><div class="tip custom-block"><p class="custom-block-title">提示</p><p>出于安全考虑, 在 <code>allow_multiple</code> 时 (默认设置), 每个这类视频默认最多播放 8-12 分钟, 以防止设置超过视频实际时长的进度.</p></div><h3 id="emby-模拟播放后为什么-最近播放-看不到" tabindex="-1">Emby 模拟播放后为什么&quot;最近播放&quot;看不到? <a class="header-anchor" href="#emby-模拟播放后为什么-最近播放-看不到" aria-label="Permalink to &quot;Emby 模拟播放后为什么&quot;最近播放&quot;看不到?&quot;">​</a></h3><p>因为在模拟播放后会自动从 &quot;最近播放&quot; 中隐藏, 因此看不到. 实际后台可以看到播放记录的.</p><h3 id="可不可以自定义" tabindex="-1">可不可以自定义... <a class="header-anchor" href="#可不可以自定义" aria-label="Permalink to &quot;可不可以自定义...&quot;">​</a></h3><p>大量的自定义内容均通过配置文件实现: <a href="/guide/配置文件">教程</a></p><p>例如:</p><ul><li>自定义启用的站点: <a href="/guide/配置文件#站点配置">教程</a></li><li>自定义 Emby 站点的 UA: <a href="/guide/配置文件#emby-子项">教程</a></li><li>自定义某些站点的自定义项: <a href="/guide/配置文件#其他的特定站点配置子项">教程</a></li></ul><p>如果有其他您需要自定义的项目, 请通过<a href="https://t.me/embykeeper_chat_bot" target="_blank" rel="noreferrer">交流群</a>或<a href="https://t.me/embykeeper_prime_bot" target="_blank" rel="noreferrer">高级用户群</a>反馈, 您也可以通过<a href="https://afdian.com/a/jackzzs" target="_blank" rel="noreferrer">爱发电</a>购买私享定制服务.</p><h3 id="运行时出现了错误-怎么解决" tabindex="-1">运行时出现了错误, 怎么解决? <a class="header-anchor" href="#运行时出现了错误-怎么解决" aria-label="Permalink to &quot;运行时出现了错误, 怎么解决?&quot;">​</a></h3><p>首先, 请检查您的错误是否与以下有关:</p><ol><li>更新控制器错误.</li><li><code>Connection reset by peer</code>.</li><li><code>ConnectionError</code>.</li></ol><p>以上均为网络波动或国际网络不通导致的问题, 请优化您的网络环境.</p><p>其他问题请<a href="#如何反馈">反馈</a>, 谢谢您的支持.</p><h3 id="如何反馈" tabindex="-1">如何反馈? <a class="header-anchor" href="#如何反馈" aria-label="Permalink to &quot;如何反馈?&quot;">​</a></h3><p>首先, 请使用左上角的搜索, 搜索相关问题, 您可以参照右侧菜单寻找相关的解决方案, 这通常可以解答大部分的疑问, 且更加便捷.</p><p>若您的疑问没有得到解答, 您可以通过<a href="https://t.me/embykeeper_chat_bot" target="_blank" rel="noreferrer">讨论群</a>和<a href="https://t.me/embykeeper_prime_bot" target="_blank" rel="noreferrer">高级用户讨论群</a>进行反馈, 其中高级用户讨论群仅限<a href="/guide/高级用户">高级用户</a>加入, 且有开发者比较及时的响应.</p><p>如果您发现一个程序上的错误或问题, 您也可以通过 <a href="https://github.com/emby-keeper/emby-keeper/issues" target="_blank" rel="noreferrer">Github Issues</a> 进行反馈.</p><h3 id="在-telegram-群组讨论-是否有被认出的风险" tabindex="-1">在 Telegram 群组讨论, 是否有被认出的风险? <a class="header-anchor" href="#在-telegram-群组讨论-是否有被认出的风险" aria-label="Permalink to &quot;在 Telegram 群组讨论, 是否有被认出的风险?&quot;">​</a></h3><p>我们的相关讨论组(<a href="https://t.me/embykeeper_chat_bot" target="_blank" rel="noreferrer">交流群</a>或<a href="https://t.me/embykeeper_prime_bot" target="_blank" rel="noreferrer">高级用户群</a>)均实现了完全匿名.</p><p>匿名群组实际上是一个机器人, 发送的消息会被广播给所有其他用户, 从而实现群聊的效果. 同时在这个过程中您的所有个人信息 (包括 头像 / 用户名 / 手机号 / 输入状态 / 在线状态 等) 均会被隐藏, 您将以一个 emoji 作为面具作为身份代号. 所以在这种群组中聊天是绝对安全的.</p><p>但是, 您需要注意不要在截图/反馈信息中带有个人隐私 (包括手机号 / Telegram UID / 用户名) 等, 若您需要发送这些信息给开发者, 高级用户请直接发送到 <a href="https://t.me/embykeeper_pm_bot" target="_blank" rel="noreferrer">PMBot</a>, 其他用户请使用马赛克遮挡并发送到 <a href="https://github.com/emby-keeper/emby-keeper/issues" target="_blank" rel="noreferrer">Github Issues</a>, 谢谢.</p><h3 id="telegram-登陆时报错" tabindex="-1">Telegram 登陆时报错 <a class="header-anchor" href="#telegram-登陆时报错" aria-label="Permalink to &quot;Telegram 登陆时报错&quot;">​</a></h3><p><strong>几种常见报错内容</strong>:</p><details class="details custom-block"><summary>The same authorization key...</summary><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>The same authorization key (session file) was used in more than one place simultaneously. You must delete your session file and log in again with your phone number or bot token.</span></span></code></pre></div><p>这说明您移动了您的 .login 文件到其他机器, 或频繁更改了 IP 地址导致强制下线. 请删除您的 .login 文件并重新登陆.</p><p><strong>对于 Docker</strong>: 容器内 <code>/app/*.login</code> 文件, 本机位置参照您的映射 (即 <code>config.toml</code> 同级目录).</p><p><strong>对于 Python / 源码构建</strong>: <code>~/.local/share/embykeeper/*.login</code> 文件.</p></details><h3 id="telegram-被登出或封禁" tabindex="-1">Telegram 被登出或封禁 <a class="header-anchor" href="#telegram-被登出或封禁" aria-label="Permalink to &quot;Telegram 被登出或封禁&quot;">​</a></h3><p>若您的账号存在安全风险时, 包括但不限于以下情况, 有小概率可能导致在使用时被登出, 或在所有设备被登出:</p><ol><li>使用 <code>+86</code> 手机号</li><li>在多个地区的 IP 地址快速切换, 例如服务器部署位置的 IP 和手机使用代理访问的 IP 位置非常不同.</li><li>账号刚刚注册.</li><li>账号使用的是虚拟号码 (VoIP) 注册.</li></ol><p>请注意, 满足这些条件也一般<strong>不会</strong>导致风控或封禁. 但是, 当您出现登出问题时, 从以上角度排查可能是一个好的方向.</p><p>同时, 如果您使用的是虚拟号码 (VoIP) 注册, 尤其是注册后无法再次访问号码的情况, 建议您参考 <a href="https://jp.v2ex.com/t/1037251" target="_blank" rel="noreferrer">如何将 Telegram 绑定邮箱</a>, 并开启两步验证, 避免一旦出现风控, 所有设备被登出, 无法再次登陆的情况.</p><p>我们发现对于风控的情况, 如果您被登出, 您可能在 0-48 小时内被限制登陆.</p><p>虽然目前为止<strong>没有</strong>收到任何使用该工具导致封禁的报告, 我们也已经对程序进行了非常合理的速率和风险控制, 我们依然无法保证不会导致封禁, 也不对这些问题负责.</p><p>Telegram 被登出其实与 Telegram 的非公开的 API 风控政策有关, 我们在常用的 Telegram 程序库 <a href="https://github.com/LonamiWebs/Telethon/issues/4321" target="_blank" rel="noreferrer">Telethon</a> 和 <a href="https://github.com/pyrogram/pyrogram/issues/1236" target="_blank" rel="noreferrer">Pyrogram</a> 中都发现了相关的反馈. 在这里可以引用这两个伟大的工具库的作者的话:</p><blockquote><p>Telethon:</p><p>首先，这不仅仅是本工具的问题。任何第三方库都可能导致帐户显示被封禁。 即使是官方应用程序在某些情况下也可能导致 Telegram 封禁帐户。像 Telethon 这样的第三方库使用起来非常简单，因此它们被滥用来发送垃圾信息，这的确可能导致 Telegram 识别某些模式并禁止可疑活动。但是，你也可能来自一个有限制的国家，或虚拟 (VoIP) 电话号码。在这种情况下，我们有一个坏消息要告诉你。Telegram 更有可能封禁这些号码，因为它们经常被用来对其他账户进行垃圾邮件攻击，且非常可能是通过类似这样的库。我们给你的最佳建议是，不要滥用 API，比如非常快速地发送大量请求。通常建议只在成熟的账户上使用这个库（而不是你刚创建的账户），并且不要执行可能被视为滥用的操作。Telegram 决定哪些操作属于此类操作，并且他们可以随时更改其运作方式。</p></blockquote><blockquote><p>Pyrogram:</p><p>我们的工具中，没有任何错误会导致您的帐户立即消失。人们应该明白，Telegram 有反垃圾邮件保护系统来防止滥用和垃圾信息，当然我们不知道它们究竟是如何工作的。我们知道的是，我们与 Telegram 分享的所有内容都可用于检测可能的垃圾邮件来源：虚拟/廉价电话号码、IP 地址（来自 Telegram 发现流量很大的国家/地区）以及泄露的第三方 API 密钥。</p></blockquote><details class="details custom-block"><summary>历史事件</summary><p>2024 年 12 月左右, 出现了大量反馈登陆后立刻被登出的案例.</p><ol><li><p><strong>无法复现</strong>: 由于我们一直无法复现, 能正常使用. 我们注册了一个新账号, 也没有出现这种现象.</p><p>因此, 我们先提醒用户自行排查注册的手机号是否为虚拟手机号等风险内容, 但是后续出现了看起来非常正常低风险的案例, 所以我们进一步对程序进行了排查.</p></li><li><p><strong>初步判断</strong>: 由于我们没有改动任何关于登陆部分的代码, 我们首先怀疑程序某处有循环的请求.</p><p>但是, 简单思考立刻排除了嫌疑:</p><ol><li>请求超限情况下, Telegram 会返回 FloodWait, 程序会等待 (<code>pyrogram</code> 的自带功能), 而不会导致风控.</li><li>有用户还没有开始使用, 刚登陆就被登出, 说明并非程序其他部分的问题.</li><li>我们进行了若干次更新, 以极其保守的方式发送请求, 依然没有缓解.</li></ol></li><li><p><strong>进一步挖掘</strong>: 我们对我们使用的库 <code>pyrogram</code> 进行相关问题分析, 发现了大量反馈, 同时其他库 (<code>telethon</code>) 也有类似的反馈.</p><p>相关问题记录在: <a href="https://github.com/emby-keeper/emby-keeper/issues/67#issuecomment-2543344275" target="_blank" rel="noreferrer">Github Issue</a> 中.</p></li><li><p><strong>问题解决</strong>: 我们采用了两种方法双管齐下, 最终解决了这个问题.</p><ol><li><p>有用户<a href="https://github.com/LonamiWebs/Telethon/issues/4051#issuecomment-1491747149" target="_blank" rel="noreferrer">反馈</a>, 使用一个特定的 <code>system_version</code> 作为请求参数登陆, 可以缓解这一现象, 且被大量认可.</p><p>我们采纳了这个方法 (虽然该方法被认为原因和机制不明), 情况有所缓解.</p></li><li><p>有用户<a href="https://github.com/pyrogram/pyrogram/issues/1461#issuecomment-2538338026" target="_blank" rel="noreferrer">反馈</a>, 使用 <code>telethon</code> 进行首次登陆, 并将 <code>session_string</code> 转换为 <code>pyrogram</code> 格式, 进行登陆, 可以解决这个问题.</p><p>我们采纳了这个方法, 在首次登陆时候使用 <code>telethon</code>, 经多位用户反馈, 彻底解决了这个问题.</p></li></ol></li><li><p><strong>总结与思考</strong>: <code>pyrogram</code> 距离上一次更新已经一年多了, 在这段时间内 Telegram 的 API 可能发生了一定的变化, 导致 <code>pyrogram</code> 的请求相较于客户端特征更加明显, 从而被 Telegram 服务器认定为风险.</p></li></ol></details><h3 id="emby-服务器的模拟登陆模式是什么" tabindex="-1">Emby 服务器的模拟登陆模式是什么? <a class="header-anchor" href="#emby-服务器的模拟登陆模式是什么" aria-label="Permalink to &quot;Emby 服务器的模拟登陆模式是什么?&quot;">​</a></h3><p>登陆过程会传递几个关键信息: <code>device</code>, <code>device_id</code>, <code>ua</code>, <code>client</code>, <code>user_id</code>.</p><p>默认情况下:</p><ul><li><code>device</code>: 设备名, 自 <a href="https://github.com/emby-keeper/emby-keeper/releases/tag/v2.6.0" target="_blank" rel="noreferrer">v2.6.0</a> 后保持恒定不变.</li><li><code>device_id</code>: 设备码, 在同一设备上恒定不变, 且不随程序重启/程序更新/容器重建变化.</li><li><code>ua</code>: 模拟 Fileball 发送的 UA, 并从几个 Fileball 版本中选取一个.</li><li><code>client</code>: 模拟 Fileball 发送的 Client 字段, 并从几个 Fileball 版本中选取一个.</li><li><code>user_id</code> (已被弃用): 由于 Fileball 在进行首次登陆时, 会发送一个随机的 UUID 作为 <code>UserID</code> 字段, 我们在先前的版本中也效仿了这一举措. 由于没有实际意义, 在新版本中这一模式已被删除, 即在首次登陆时不附加 <code>UserID</code> 字段, 登陆后根据服务器返回的 <code>UserID</code> 附加到后续请求中.</li></ul><p>根据我们在自建的 Emby 服务器和 Jellyfin 服务器中的测试中, 多次保活不会导致后台设备显示数量, 或设备 UUID 数量的上涨.</p><p>你可以查看<a href="https://github.com/emby-keeper/emby-keeper/blob/main/embykeeper/embywatcher/emby.py" target="_blank" rel="noreferrer">源代码</a>以更清晰地了解逻辑.</p>`,63)]))}const m=a(r,[["render",l]]);export{c as __pageData,m as default};
